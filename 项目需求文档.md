# QuitDay - 项目需求文档

## 1. 项目概述

### 1.1 项目名称
**QuitDay**

### 1.2 核心概念
QuitDay 是一款专注于帮助用户**习惯追踪**的跨平台应用，类似于 Quitzilla。它的核心价值在于通过直观的“戒断时钟”提供持续的正反馈，并通过用户完全掌控的数据备份方案，确保记录的安全与持久。

### 1.3 设计哲学
- **专注**：仅保留最核心的戒断追踪功能，避免功能膨胀。
- **自主**：用户数据完全本地存储，并通过开放格式（CSV）和协议（WebDAV）进行备份，确保用户对自己的数据拥有绝对控制权。
- **现代**：遵循 Flutter 的 Material 3 设计系统，提供清新、动态且一致的视觉体验。

## 2. 详细功能需求

### 2.1 核心戒断追踪功能 (源自 Quitzilla)
1. **习惯管理**
   - 创建任意数量的待戒除习惯（如“吸烟”、“熬夜”）。
   - 为每个习惯设定初始的“戒断开始日期”。
   - 可编辑或删除已创建的习惯。

2. **戒断仪表盘**
   - 首页核心位置显示当前已坚持的**戒断时长**，精确到天、小时、分钟。
   - 以清晰的方式展示为每个习惯节省的**金钱**和**时间**（基于用户预设的每次消耗）。
   - 显示连续达成里程碑（如7天、30天、100天）的庆祝信息。

3. **记录与重置**
   - 提供“今天坚持住了”的快速打卡按钮。
   - 如果破戒，允许用户手动“重置”某个习惯的时钟，并可选择记录破戒原因（可选）。

### 2.2 数据备份与恢复功能 (核心扩展需求)
1. **本地 CSV 文件支持**
   - **导出**：将全部习惯数据（包括历史记录）导出为标准 CSV 格式文件，保存至用户设备存储的任意位置。
   - **导入**：从用户选择的 CSV 文件中读取数据，并完整恢复至应用。需处理与现有数据的合并或覆盖逻辑。

2. **WebDAV 远程同步支持**
   - **配置**：在应用设置中允许用户配置 WebDAV 服务器地址、用户名和密码。
   - **上传/备份**：将数据文件上传至用户指定的 WebDAV 服务器目录。
   - **下载/恢复**：从 WebDAV 服务器目录列出可用的备份文件，并选择下载恢复。
   - **注意**：所有网络操作需在后台进行，并提供明确的成功/失败状态提示。

### 2.3 用户界面需求
1. **遵循 Flutter Material 3 设计规范**
   - 使用 Flutter 的 Material 3 色彩系统、字体比例、形状设计和组件。
   - 实现动态色彩（Dynamic Color）功能，允许应用主题从用户系统设置中提取配色。
   - 界面布局应简洁、直观，重点突出“戒断时钟”。

## 3. 技术实现方案

### 3.1 技术栈
- **语言**: Dart
- **UI 框架**: Flutter
- **设计语言**: Flutter Material 3 (`material3` package)
- **本地数据库**: SQLite (通过 `sqflite` package)
- **CSV 处理**: `csv` package
- **WebDAV 客户端**: `webdav_client` 或同等库
- **架构模式**: Provider 或 Riverpod 状态管理

### 3.2 数据架构
- **本地存储**：使用 SQLite 数据库（通过 `sqflite` package）存储所有习惯、打卡记录和统计数据。
- **CSV 结构**：导出文件应包含表头，字段例如：`habit_id, habit_name, start_date, last_reset_date, total_days_saved, money_saved_per_unit, notes`。
- **备份逻辑**：WebDAV 备份本质上是将本地生成的 CSV 文件上传至云端。恢复时，从云端下载 CSV 并解析回 SQLite 数据库。

## 4. 分发与品牌指南

### 4.1 品牌定义
- **名称**: QuitDay
- **寓意**: 专注于赢下每一天（One Day at a Time）。
- **建议标语**: "Track your quit, reclaim your day."
- **主色调**: 建议使用积极、充满活力的色调（如绿色 `#4CAF50` 或橙色 `#FF9800`），避免消极的红色。
- **应用图标**: 建议设计为简洁的日历样式，上面有一个被显著标记或高亮的数字（如“Day 30”）。

### 4.2 分发平台准备
**目标平台**:
1.  **GitHub**：作为主要的开源代码托管和问题追踪平台。
2.  **移动平台**：
    - **Google Play Store**：面向Android用户。
    - **Apple App Store**：面向iOS用户。
3.  **桌面平台**：
    - **Windows**：通过Windows应用商店或独立安装包。
    - **macOS**：通过Mac App Store或独立安装包。
    - **Linux**：通过Flatpak、Snap或AppImage等格式。
4.  **Web平台**：
    - 提供Web版本，可通过浏览器访问。

**关键检查清单**:
- **隐私政策**：编写并在应用内展示，明确说明所有数据存储于本地，备份文件由用户完全控制。
- **开源合规**：
  - 选择兼容的开源许可证（如 GPL-3.0）。
  - 确保所有依赖库均为兼容的开源协议。
  - 为各平台准备纯净的构建脚本，移除所有专有服务依赖。
- **商店材料**：
  - 准备高质量的屏幕截图、宣传图和应用描述，适配各平台的要求。
  - 为各应用商店填写完整的应用信息和数据安全表单。
